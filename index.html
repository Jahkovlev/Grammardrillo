<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grammardrillo - English Grammar Drill</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            padding: 30px;
            max-width: 400px;
            width: 100%;
            text-align: center;
        }

        h1 {
            color: #333;
            margin-bottom: 20px;
            font-size: 28px;
        }

        h2 {
            color: #555;
            margin-bottom: 20px;
            font-size: 24px;
        }

        .welcome-text {
            font-size: 20px;
            color: #666;
            margin-bottom: 30px;
            line-height: 1.6;
        }

        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 30px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        button:hover {
            background: #5a67d8;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.5);
        }

        button:active {
            transform: translateY(0);
        }

        button:disabled {
            background: #cbd5e0;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .menu-button {
            display: block;
            width: 100%;
            margin-bottom: 15px;
            background: #48bb78;
        }

        .menu-button:hover {
            background: #38a169;
        }

        .back-button {
            background: #f56565;
            padding: 10px 20px;
            font-size: 16px;
        }

        .back-button:hover {
            background: #e53e3e;
        }

        .navigation-buttons {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 20px;
            gap: 10px;
        }

        .button-row {
            display: flex;
            justify-content: space-between;
            width: 100%;
            max-width: 350px;
        }
        
        .navigation-buttons .back-button {
            margin-top: 10px;
        }

        .nav-button {
            background: #4299e1;
            padding: 10px 25px;
            font-size: 16px;
        }

        .nav-button:hover {
            background: #3182ce;
        }

        .exercise-container {
            background: #f7fafc;
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
        }

        .sentence {
            font-size: 20px;
            color: #2d3748;
            margin: 15px 0;
            padding: 15px;
            background: white;
            border-radius: 10px;
            border: 2px solid #e2e8f0;
            transition: all 0.3s ease;
        }

        .sentence:hover {
            border-color: #667eea;
            transform: translateX(5px);
        }

        .exercise-title {
            font-size: 18px;
            color: #718096;
            margin-bottom: 20px;
            font-style: italic;
        }

        .hidden {
            display: none;
        }

        .verb-info {
            background: #bee3f8;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 15px;
            font-weight: bold;
            color: #2c5282;
        }

        .scheme-info {
            font-size: 14px;
            color: #718096;
            margin-bottom: 10px;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-left: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .error-message {
            color: #e53e3e;
            font-size: 14px;
            margin-top: 10px;
            padding: 10px;
            background: #fed7d7;
            border-radius: 8px;
        }

        .nav-button.next-button {
            background: #48bb78;
        }
        
        .nav-button.next-button:hover {
            background: #38a169;
        }
        
        .russian {
            font-size: 28px;
            color: #5a67d8;
            font-weight: bold;
            margin-bottom: 20px;
            padding: 30px 20px 20px 20px;
            background: #e6f2ff;
            border-radius: 10px;
            text-align: center;
            display: block !important;
            position: relative;
        }
        
        .tense-badge {
            position: absolute;
            top: -10px;
            right: 20px;
            background: #667eea;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: normal;
            box-shadow: 0 2px 10px rgba(102, 126, 234, 0.3);
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: all 0.3s ease;
            animation: badgeAppear 0.5s ease-out;
            cursor: default;
            user-select: none;
        }
        
        @keyframes badgeAppear {
            from {
                opacity: 0;
                transform: scale(0.8) translateY(-10px);
            }
            50% {
                transform: scale(1.1) translateY(0);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }
        
        .tense-badge:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.5);
        }
        
        .tense-badge.present { background: #48bb78; }
        .tense-badge.present:hover { box-shadow: 0 4px 15px rgba(72, 187, 120, 0.5); }
        
        .tense-badge.past { background: #f56565; }
        .tense-badge.past:hover { box-shadow: 0 4px 15px rgba(245, 101, 101, 0.5); }
        
        .tense-badge.future { background: #4299e1; }
        .tense-badge.future:hover { box-shadow: 0 4px 15px rgba(66, 153, 225, 0.5); }
        
        .tense-badge.present-perfect { background: #9f7aea; }
        .tense-badge.present-perfect:hover { box-shadow: 0 4px 15px rgba(159, 122, 234, 0.5); }
        
        .tense-badge.past-perfect { background: #ed8936; }
        .tense-badge.past-perfect:hover { box-shadow: 0 4px 15px rgba(237, 137, 54, 0.5); }
        
        .english {
            font-size: 22px;
            color: #2d3748;
            margin: 10px 0;
            padding: 15px;
            background: #f7fafc;
            border-radius: 8px;
            transition: all 0.3s ease;
            opacity: 0;
            animation: fadeIn 0.5s forwards;
        }
        
        @keyframes fadeIn {
            to {
                opacity: 1;
            }
        }
        
        .test-item {
            cursor: pointer;
            user-select: none;
            width: 100%;
        }
        
        #testContainer {
            min-height: 400px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        
        #testContainer:after {
            content: 'Tap to reveal answer';
            position: absolute;
            bottom: 10px;
            right: 10px;
            font-size: 14px;
            color: #a0aec0;
            font-style: italic;
        }
        
        #testContainer.complete:after {
            content: 'Complete! Try a new example';
        }
        
        @media (max-width: 480px) {
            .container {
                padding: 20px;
            }
            
            button {
                padding: 12px 25px;
                font-size: 16px;
            }
            
            .navigation-buttons {
                justify-content: center;
            }
            
            .nav-button {
                margin: 5px;
            }
            
            .tense-badge {
                animation: badgeAppear 0.5s ease-out, pulseMobile 2s ease-in-out infinite;
                font-size: 12px;
                padding: 4px 12px;
            }
            
            .russian {
                font-size: 24px;
                padding: 35px 15px 15px 15px;
            }
        }
        
        @keyframes pulseMobile {
            0%, 100% {
                box-shadow: 0 2px 10px rgba(102, 126, 234, 0.3);
            }
            50% {
                box-shadow: 0 2px 20px rgba(102, 126, 234, 0.6);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Welcome Screen -->
        <div id="welcomeScreen" class="screen">
            <h1>Welcome to Grammardrillo!</h1>
            <p class="welcome-text">Let's go and get you fluency NOW!</p>
            <p style="font-size: 14px; color: #718096; margin-top: 20px;">‚ú® Works offline - no internet required!</p>
            <button onclick="showMainMenu()">GO!</button>
        </div>

        <!-- Main Menu -->
        <div id="mainMenu" class="screen hidden">
            <h1>Main Menu</h1>
            <button class="menu-button" onclick="showExercises()">Exercises</button>
            <button class="menu-button" onclick="showTestYourself()">Test Yourself</button>
        </div>

        <!-- Exercises Menu -->
        <div id="exercisesMenu" class="screen hidden">
            <h2>Core Grammar</h2>
            <button class="menu-button" onclick="startPresentSimple()">Present Simple</button>
            <button class="menu-button" onclick="startPastSimple()">Past Simple</button>
            <button class="menu-button" onclick="startFutureSimple()">Future Simple</button>
            <button class="menu-button" onclick="startPresentPerfect()">Present Perfect</button>
            <button class="menu-button" onclick="startPastPerfect()">Past Perfect</button>
            <button class="back-button" onclick="showMainMenu()">Back to Main Menu</button>
        </div>

        <!-- Present Simple Exercise -->
        <div id="presentSimple" class="screen hidden">
            <h2>Present Simple</h2>
            <p class="exercise-title">Practice changing subjects while keeping the same verb</p>
            
            <div class="verb-info" id="currentVerb">Current verb: go</div>
            <div class="scheme-info" id="schemeInfo">Loading...</div>
            
            <div class="exercise-container">
                <div id="sentenceDisplay">
                    <div class="sentence" id="sentence1">Loading...</div>
                    <div class="sentence" id="sentence2">Loading...</div>
                    <div class="sentence" id="sentence3">Loading...</div>
                    <div class="sentence" id="sentence4">Loading...</div>
                </div>
            </div>

            <div id="errorMessage" class="error-message hidden"></div>

            <div class="navigation-buttons">
                <div class="button-row">
                    <button class="nav-button" id="backBtn" onclick="previousSubject()">Back</button>
                    <button class="nav-button next-button" id="nextBtn" onclick="nextSubject()">Next</button>
                </div>
                <div class="button-row">
                    <button class="nav-button" onclick="playAudioPresent()">üîä Play</button>
                    <button class="nav-button" id="changeWordBtn" onclick="changeVerb()">Change the Word</button>
                </div>
                <button class="back-button" onclick="showExercises()">Back to Exercises</button>
            </div>
        </div>

        <!-- Future Simple Exercise -->
        <div id="futureSimple" class="screen hidden">
            <h2>Future Simple</h2>
            <p class="exercise-title">Practice changing subjects with future tense</p>
            
            <div class="verb-info" id="currentVerbFuture">Current verb: go</div>
            <div class="scheme-info" id="schemeInfoFuture">Loading...</div>
            
            <div class="exercise-container">
                <div id="sentenceDisplayFuture">
                    <div class="sentence" id="sentenceFuture1">Loading...</div>
                    <div class="sentence" id="sentenceFuture2">Loading...</div>
                    <div class="sentence" id="sentenceFuture3">Loading...</div>
                    <div class="sentence" id="sentenceFuture4">Loading...</div>
                </div>
            </div>

            <div id="errorMessageFuture" class="error-message hidden"></div>

            <div class="navigation-buttons">
                <div class="button-row">
                    <button class="nav-button" id="backBtnFuture" onclick="previousSubjectFuture()">Back</button>
                    <button class="nav-button next-button" id="nextBtnFuture" onclick="nextSubjectFuture()">Next</button>
                </div>
                <div class="button-row">
                    <button class="nav-button" onclick="playAudioFuture()">üîä Play</button>
                    <button class="nav-button" id="changeWordBtnFuture" onclick="changeVerbFuture()">Change the Word</button>
                </div>
                <button class="back-button" onclick="showExercises()">Back to Exercises</button>
            </div>
        </div>

        <!-- Past Simple Exercise -->
        <div id="pastSimple" class="screen hidden">
            <h2>Past Simple</h2>
            <p class="exercise-title">Practice changing subjects with past tense</p>
            
            <div class="verb-info" id="currentVerbPast">Current verb: go</div>
            <div class="scheme-info" id="schemeInfoPast">Loading...</div>
            
            <div class="exercise-container">
                <div id="sentenceDisplayPast">
                    <div class="sentence" id="sentencePast1">Loading...</div>
                    <div class="sentence" id="sentencePast2">Loading...</div>
                    <div class="sentence" id="sentencePast3">Loading...</div>
                    <div class="sentence" id="sentencePast4">Loading...</div>
                </div>
            </div>

            <div id="errorMessagePast" class="error-message hidden"></div>

            <div class="navigation-buttons">
                <div class="button-row">
                    <button class="nav-button" id="backBtnPast" onclick="previousSubjectPast()">Back</button>
                    <button class="nav-button next-button" id="nextBtnPast" onclick="nextSubjectPast()">Next</button>
                </div>
                <div class="button-row">
                    <button class="nav-button" onclick="playAudioPast()">üîä Play</button>
                    <button class="nav-button" id="changeWordBtnPast" onclick="changeVerbPast()">Change the Word</button>
                </div>
                <button class="back-button" onclick="showExercises()">Back to Exercises</button>
            </div>
        </div>

        <!-- Present Perfect Exercise -->
        <div id="presentPerfect" class="screen hidden">
            <h2>Present Perfect</h2>
            <p class="exercise-title">Practice changing subjects with present perfect tense</p>
            
            <div class="verb-info" id="currentVerbPresentPerfect">Current verb: go</div>
            <div class="scheme-info" id="schemeInfoPresentPerfect">Loading...</div>
            
            <div class="exercise-container">
                <div id="sentenceDisplayPresentPerfect">
                    <div class="sentence" id="sentencePresentPerfect1">Loading...</div>
                    <div class="sentence" id="sentencePresentPerfect2">Loading...</div>
                    <div class="sentence" id="sentencePresentPerfect3">Loading...</div>
                    <div class="sentence" id="sentencePresentPerfect4">Loading...</div>
                </div>
            </div>

            <div id="errorMessagePresentPerfect" class="error-message hidden"></div>

            <div class="navigation-buttons">
                <div class="button-row">
                    <button class="nav-button" id="backBtnPresentPerfect" onclick="previousSubjectPresentPerfect()">Back</button>
                    <button class="nav-button next-button" id="nextBtnPresentPerfect" onclick="nextSubjectPresentPerfect()">Next</button>
                </div>
                <div class="button-row">
                    <button class="nav-button" onclick="playAudioPresentPerfect()">üîä Play</button>
                    <button class="nav-button" id="changeWordBtnPresentPerfect" onclick="changeVerbPresentPerfect()">Change the Word</button>
                </div>
                <button class="back-button" onclick="showExercises()">Back to Exercises</button>
            </div>
        </div>

        <!-- Past Perfect Exercise -->
        <div id="pastPerfect" class="screen hidden">
            <h2>Past Perfect</h2>
            <p class="exercise-title">Practice changing subjects with past perfect tense</p>
            
            <div class="verb-info" id="currentVerbPastPerfect">Current verb: go</div>
            <div class="scheme-info" id="schemeInfoPastPerfect">Loading...</div>
            
            <div class="exercise-container">
                <div id="sentenceDisplayPastPerfect">
                    <div class="sentence" id="sentencePastPerfect1">Loading...</div>
                    <div class="sentence" id="sentencePastPerfect2">Loading...</div>
                    <div class="sentence" id="sentencePastPerfect3">Loading...</div>
                    <div class="sentence" id="sentencePastPerfect4">Loading...</div>
                </div>
            </div>

            <div id="errorMessagePastPerfect" class="error-message hidden"></div>

            <div class="navigation-buttons">
                <div class="button-row">
                    <button class="nav-button" id="backBtnPastPerfect" onclick="previousSubjectPastPerfect()">Back</button>
                    <button class="nav-button next-button" id="nextBtnPastPerfect" onclick="nextSubjectPastPerfect()">Next</button>
                </div>
                <div class="button-row">
                    <button class="nav-button" onclick="playAudioPastPerfect()">üîä Play</button>
                    <button class="nav-button" id="changeWordBtnPastPerfect" onclick="changeVerbPastPerfect()">Change the Word</button>
                </div>
                <button class="back-button" onclick="showExercises()">Back to Exercises</button>
            </div>
        </div>

        <!-- Test Yourself -->
        <div id="testYourself" class="screen hidden">
            <h2>Test Yourself</h2>
            <p style="font-size: 14px; color: #718096; margin-bottom: 10px;">All 5 tenses: Present Simple, Past Simple, Future Simple, Present Perfect, Past Perfect</p>
            <p class="exercise-title">Translate this sentence and put it in the negative, question and wh-question form.<br><strong>Pay attention to the tense badge!</strong> The required tense is shown in the colored badge.<br>Tap the example to see the translation.</p>
            
            <div class="exercise-container" id="testContainer" onclick="revealNext()">
                <div class="test-item">
                    <div class="russian" id="russianSentence">Loading...</div>
                    <div class="english hidden" id="englishPositive"></div>
                    <div class="english hidden" id="englishNegative"></div>
                    <div class="english hidden" id="englishQuestion"></div>
                    <div class="english hidden" id="englishWhQuestion"></div>
                </div>
            </div>
            
            <div id="testError" class="error-message hidden"></div>
            
            <div class="navigation-buttons">
                <button class="nav-button" onclick="generateNewTest()">New Example</button>
                <button class="back-button" onclick="showMainMenu()">Back to Main Menu</button>
            </div>
            
            <div style="margin-top: 30px; padding: 15px; background: #f7fafc; border-radius: 10px; text-align: center;">
                <p style="font-size: 12px; color: #718096; margin-bottom: 10px;">Tense Color Guide:</p>
                <div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 10px;">
                    <span style="background: #48bb78; color: white; padding: 3px 10px; border-radius: 15px; font-size: 11px;">Present Simple</span>
                    <span style="background: #f56565; color: white; padding: 3px 10px; border-radius: 15px; font-size: 11px;">Past Simple</span>
                    <span style="background: #4299e1; color: white; padding: 3px 10px; border-radius: 15px; font-size: 11px;">Future Simple</span>
                    <span style="background: #9f7aea; color: white; padding: 3px 10px; border-radius: 15px; font-size: 11px;">Present Perfect</span>
                    <span style="background: #ed8936; color: white; padding: 3px 10px; border-radius: 15px; font-size: 11px;">Past Perfect</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Comprehensive Verb Dictionary with added Present Perfect and Past Perfect
        const verbDictionary = {
            // BE verb
            'be': {
                present: {
                    'I': {
                        positive: 'I am',
                        negative: 'I am not',
                        question: 'Am I?',
                        whQuestion: 'Who am I?',
                        russian: '–Ø –µ—Å—Ç—å'
                    },
                    'you': {
                        positive: 'you are',
                        negative: 'you are not',
                        question: 'Are you?',
                        whQuestion: 'Who are you?',
                        russian: '—Ç—ã –µ—Å—Ç—å'
                    },
                    'he': {
                        positive: 'he is',
                        negative: 'he is not',
                        question: 'Is he?',
                        whQuestion: 'Who is he?',
                        russian: '–æ–Ω –µ—Å—Ç—å'
                    },
                    'she': {
                        positive: 'she is',
                        negative: 'she is not',
                        question: 'Is she?',
                        whQuestion: 'Who is she?',
                        russian: '–æ–Ω–∞ –µ—Å—Ç—å'
                    },
                    'it': {
                        positive: 'it is',
                        negative: 'it is not',
                        question: 'Is it?',
                        whQuestion: 'Who is it?',
                        russian: '–æ–Ω–æ –µ—Å—Ç—å'
                    },
                    'we': {
                        positive: 'we are',
                        negative: 'we are not',
                        question: 'Are we?',
                        whQuestion: 'Who are we?',
                        russian: '–º—ã –µ—Å—Ç—å'
                    },
                    'they': {
                        positive: 'they are',
                        negative: 'they are not',
                        question: 'Are they?',
                        whQuestion: 'Who are they?',
                        russian: '–æ–Ω–∏ –µ—Å—Ç—å'
                    }
                },
                past: {
                    'I': {
                        positive: 'I was',
                        negative: 'I was not',
                        question: 'Was I?',
                        whQuestion: 'Who was I?',
                        russian: '–Ø –±—ã–ª/–±—ã–ª–∞'
                    },
                    'you': {
                        positive: 'you were',
                        negative: 'you were not',
                        question: 'Were you?',
                        whQuestion: 'Who were you?',
                        russian: '—Ç—ã –±—ã–ª/–±—ã–ª–∞'
                    },
                    'he': {
                        positive: 'he was',
                        negative: 'he was not',
                        question: 'Was he?',
                        whQuestion: 'Who was he?',
                        russian: '–æ–Ω –±—ã–ª'
                    },
                    'she': {
                        positive: 'she was',
                        negative: 'she was not',
                        question: 'Was she?',
                        whQuestion: 'Who was she?',
                        russian: '–æ–Ω–∞ –±—ã–ª–∞'
                    },
                    'it': {
                        positive: 'it was',
                        negative: 'it was not',
                        question: 'Was it?',
                        whQuestion: 'Who was it?',
                        russian: '–æ–Ω–æ –±—ã–ª–æ'
                    },
                    'we': {
                        positive: 'we were',
                        negative: 'we were not',
                        question: 'Were we?',
                        whQuestion: 'Who were we?',
                        russian: '–º—ã –±—ã–ª–∏'
                    },
                    'they': {
                        positive: 'they were',
                        negative: 'they were not',
                        question: 'Were they?',
                        whQuestion: 'Who were they?',
                        russian: '–æ–Ω–∏ –±—ã–ª–∏'
                    }
                },
                future: {
                    'I': {
                        positive: 'I will be',
                        negative: 'I will not be',
                        question: 'Will I be?',
                        whQuestion: 'Who will I be?',
                        russian: '–Ø –±—É–¥—É'
                    },
                    'you': {
                        positive: 'you will be',
                        negative: 'you will not be',
                        question: 'Will you be?',
                        whQuestion: 'Who will you be?',
                        russian: '—Ç—ã –±—É–¥–µ—à—å'
                    },
                    'he': {
                        positive: 'he will be',
                        negative: 'he will not be',
                        question: 'Will he be?',
                        whQuestion: 'Who will he be?',
                        russian: '–æ–Ω –±—É–¥–µ—Ç'
                    },
                    'she': {
                        positive: 'she will be',
                        negative: 'she will not be',
                        question: 'Will she be?',
                        whQuestion: 'Who will she be?',
                        russian: '–æ–Ω–∞ –±—É–¥–µ—Ç'
                    },
                    'it': {
                        positive: 'it will be',
                        negative: 'it will not be',
                        question: 'Will it be?',
                        whQuestion: 'Who will it be?',
                        russian: '–æ–Ω–æ –±—É–¥–µ—Ç'
                    },
                    'we': {
                        positive: 'we will be',
                        negative: 'we will not be',
                        question: 'Will we be?',
                        whQuestion: 'Who will we be?',
                        russian: '–º—ã –±—É–¥–µ–º'
                    },
                    'they': {
                        positive: 'they will be',
                        negative: 'they will not be',
                        question: 'Will they be?',
                        whQuestion: 'Who will they be?',
                        russian: '–æ–Ω–∏ –±—É–¥—É—Ç'
                    }
                },
                presentPerfect: {
                    'I': {
                        positive: 'I have been',
                        negative: "I haven't been",
                        question: 'Have I been?',
                        whQuestion: 'Where have I been?',
                        russian: '–Ø –±—ã–ª/–±—ã–ª–∞'
                    },
                    'you': {
                        positive: 'you have been',
                        negative: "you haven't been",
                        question: 'Have you been?',
                        whQuestion: 'Where have you been?',
                        russian: '—Ç—ã –±—ã–ª/–±—ã–ª–∞'
                    },
                    'he': {
                        positive: 'he has been',
                        negative: "he hasn't been",
                        question: 'Has he been?',
                        whQuestion: 'Where has he been?',
                        russian: '–æ–Ω –±—ã–ª'
                    },
                    'she': {
                        positive: 'she has been',
                        negative: "she hasn't been",
                        question: 'Has she been?',
                        whQuestion: 'Where has she been?',
                        russian: '–æ–Ω–∞ –±—ã–ª–∞'
                    },
                    'it': {
                        positive: 'it has been',
                        negative: "it hasn't been",
                        question: 'Has it been?',
                        whQuestion: 'Where has it been?',
                        russian: '–æ–Ω–æ –±—ã–ª–æ'
                    },
                    'we': {
                        positive: 'we have been',
                        negative: "we haven't been",
                        question: 'Have we been?',
                        whQuestion: 'Where have we been?',
                        russian: '–º—ã –±—ã–ª–∏'
                    },
                    'they': {
                        positive: 'they have been',
                        negative: "they haven't been",
                        question: 'Have they been?',
                        whQuestion: 'Where have they been?',
                        russian: '–æ–Ω–∏ –±—ã–ª–∏'
                    }
                },
                pastPerfect: {
                    'I': {
                        positive: 'I had been',
                        negative: "I hadn't been",
                        question: 'Had I been?',
                        whQuestion: 'Where had I been?',
                        russian: '–Ø –±—ã–ª/–±—ã–ª–∞ (–¥–æ —Ç–æ–≥–æ)'
                    },
                    'you': {
                        positive: 'you had been',
                        negative: "you hadn't been",
                        question: 'Had you been?',
                        whQuestion: 'Where had you been?',
                        russian: '—Ç—ã –±—ã–ª/–±—ã–ª–∞ (–¥–æ —Ç–æ–≥–æ)'
                    },
                    'he': {
                        positive: 'he had been',
                        negative: "he hadn't been",
                        question: 'Had he been?',
                        whQuestion: 'Where had he been?',
                        russian: '–æ–Ω –±—ã–ª (–¥–æ —Ç–æ–≥–æ)'
                    },
                    'she': {
                        positive: 'she had been',
                        negative: "she hadn't been",
                        question: 'Had she been?',
                        whQuestion: 'Where had she been?',
                        russian: '–æ–Ω–∞ –±—ã–ª–∞ (–¥–æ —Ç–æ–≥–æ)'
                    },
                    'it': {
                        positive: 'it had been',
                        negative: "it hadn't been",
                        question: 'Had it been?',
                        whQuestion: 'Where had it been?',
                        russian: '–æ–Ω–æ –±—ã–ª–æ (–¥–æ —Ç–æ–≥–æ)'
                    },
                    'we': {
                        positive: 'we had been',
                        negative: "we hadn't been",
                        question: 'Had we been?',
                        whQuestion: 'Where had we been?',
                        russian: '–º—ã –±—ã–ª–∏ (–¥–æ —Ç–æ–≥–æ)'
                    },
                    'they': {
                        positive: 'they had been',
                        negative: "they hadn't been",
                        question: 'Had they been?',
                        whQuestion: 'Where had they been?',
                        russian: '–æ–Ω–∏ –±—ã–ª–∏ (–¥–æ —Ç–æ–≥–æ)'
                    }
                }
            },
            
            // GO verb
            'go': {
                present: {
                    'I': {
                        positive: 'I go',
                        negative: "I don't go",
                        question: 'Do I go?',
                        whQuestion: 'Where do I go?',
                        russian: '–Ø –∏–¥—É'
                    },
                    'you': {
                        positive: 'you go',
                        negative: "you don't go",
                        question: 'Do you go?',
                        whQuestion: 'Where do you go?',
                        russian: '—Ç—ã –∏–¥—ë—à—å'
                    },
                    'he': {
                        positive: 'he goes',
                        negative: "he doesn't go",
                        question: 'Does he go?',
                        whQuestion: 'Where does he go?',
                        russian: '–æ–Ω –∏–¥—ë—Ç'
                    },
                    'she': {
                        positive: 'she goes',
                        negative: "she doesn't go",
                        question: 'Does she go?',
                        whQuestion: 'Where does she go?',
                        russian: '–æ–Ω–∞ –∏–¥—ë—Ç'
                    },
                    'it': {
                        positive: 'it goes',
                        negative: "it doesn't go",
                        question: 'Does it go?',
                        whQuestion: 'Where does it go?',
                        russian: '–æ–Ω–æ –∏–¥—ë—Ç'
                    },
                    'we': {
                        positive: 'we go',
                        negative: "we don't go",
                        question: 'Do we go?',
                        whQuestion: 'Where do we go?',
                        russian: '–º—ã –∏–¥—ë–º'
                    },
                    'they': {
                        positive: 'they go',
                        negative: "they don't go",
                        question: 'Do they go?',
                        whQuestion: 'Where do they go?',
                        russian: '–æ–Ω–∏ –∏–¥—É—Ç'
                    }
                },
                past: {
                    'I': {
                        positive: 'I went',
                        negative: "I didn't go",
                        question: 'Did I go?',
                        whQuestion: 'Where did I go?',
                        russian: '–Ø –ø–æ—à—ë–ª/–ø–æ—à–ª–∞'
                    },
                    'you': {
                        positive: 'you went',
                        negative: "you didn't go",
                        question: 'Did you go?',
                        whQuestion: 'Where did you go?',
                        russian: '—Ç—ã –ø–æ—à—ë–ª/–ø–æ—à–ª–∞'
                    },
                    'he': {
                        positive: 'he went',
                        negative: "he didn't go",
                        question: 'Did he go?',
                        whQuestion: 'Where did he go?',
                        russian: '–æ–Ω –ø–æ—à—ë–ª'
                    },
                    'she': {
                        positive: 'she went',
                        negative: "she didn't go",
                        question: 'Did she go?',
                        whQuestion: 'Where did she go?',
                        russian: '–æ–Ω–∞ –ø–æ—à–ª–∞'
                    },
                    'it': {
                        positive: 'it went',
                        negative: "it didn't go",
                        question: 'Did it go?',
                        whQuestion: 'Where did it go?',
                        russian: '–æ–Ω–æ –ø–æ—à–ª–æ'
                    },
                    'we': {
                        positive: 'we went',
                        negative: "we didn't go",
                        question: 'Did we go?',
                        whQuestion: 'Where did we go?',
                        russian: '–º—ã –ø–æ—à–ª–∏'
                    },
                    'they': {
                        positive: 'they went',
                        negative: "they didn't go",
                        question: 'Did they go?',
                        whQuestion: 'Where did they go?',
                        russian: '–æ–Ω–∏ –ø–æ—à–ª–∏'
                    }
                },
                future: {
                    'I': {
                        positive: 'I will go',
                        negative: "I won't go",
                        question: 'Will I go?',
                        whQuestion: 'Where will I go?',
                        russian: '–Ø –ø–æ–π–¥—É'
                    },
                    'you': {
                        positive: 'you will go',
                        negative: "you won't go",
                        question: 'Will you go?',
                        whQuestion: 'Where will you go?',
                        russian: '—Ç—ã –ø–æ–π–¥—ë—à—å'
                    },
                    'he': {
                        positive: 'he will go',
                        negative: "he won't go",
                        question: 'Will he go?',
                        whQuestion: 'Where will he go?',
                        russian: '–æ–Ω –ø–æ–π–¥—ë—Ç'
                    },
                    'she': {
                        positive: 'she will go',
                        negative: "she won't go",
                        question: 'Will she go?',
                        whQuestion: 'Where will she go?',
                        russian: '–æ–Ω–∞ –ø–æ–π–¥—ë—Ç'
                    },
                    'it': {
                        positive: 'it will go',
                        negative: "it won't go",
                        question: 'Will it go?',
                        whQuestion: 'Where will it go?',
                        russian: '–æ–Ω–æ –ø–æ–π–¥—ë—Ç'
                    },
                    'we': {
                        positive: 'we will go',
                        negative: "we won't go",
                        question: 'Will we go?',
                        whQuestion: 'Where will we go?',
                        russian: '–º—ã –ø–æ–π–¥—ë–º'
                    },
                    'they': {
                        positive: 'they will go',
                        negative: "they won't go",
                        question: 'Will they go?',
                        whQuestion: 'Where will they go?',
                        russian: '–æ–Ω–∏ –ø–æ–π–¥—É—Ç'
                    }
                },
                presentPerfect: {
                    'I': {
                        positive: 'I have gone',
                        negative: "I haven't gone",
                        question: 'Have I gone?',
                        whQuestion: 'Where have I gone?',
                        russian: '–Ø —É—à—ë–ª/—É—à–ª–∞'
                    },
                    'you': {
                        positive: 'you have gone',
                        negative: "you haven't gone",
                        question: 'Have you gone?',
                        whQuestion: 'Where have you gone?',
                        russian: '—Ç—ã —É—à—ë–ª/—É—à–ª–∞'
                    },
                    'he': {
                        positive: 'he has gone',
                        negative: "he hasn't gone",
                        question: 'Has he gone?',
                        whQuestion: 'Where has he gone?',
                        russian: '–æ–Ω —É—à—ë–ª'
                    },
                    'she': {
                        positive: 'she has gone',
                        negative: "she hasn't gone",
                        question: 'Has she gone?',
                        whQuestion: 'Where has she gone?',
                        russian: '–æ–Ω–∞ —É—à–ª–∞'
                    },
                    'it': {
                        positive: 'it has gone',
                        negative: "it hasn't gone",
                        question: 'Has it gone?',
                        whQuestion: 'Where has it gone?',
                        russian: '–æ–Ω–æ —É—à–ª–æ'
                    },
                    'we': {
                        positive: 'we have gone',
                        negative: "we haven't gone",
                        question: 'Have we gone?',
                        whQuestion: 'Where have we gone?',
                        russian: '–º—ã —É—à–ª–∏'
                    },
                    'they': {
                        positive: 'they have gone',
                        negative: "they haven't gone",
                        question: 'Have they gone?',
                        whQuestion: 'Where have they gone?',
                        russian: '–æ–Ω–∏ —É—à–ª–∏'
                    }
                },
                pastPerfect: {
                    'I': {
                        positive: 'I had gone',
                        negative: "I hadn't gone",
                        question: 'Had I gone?',
                        whQuestion: 'Where had I gone?',
                        russian: '–Ø —É—à—ë–ª/—É—à–ª–∞ (–¥–æ —Ç–æ–≥–æ)'
                    },
                    'you': {
                        positive: 'you had gone',
                        negative: "you hadn't gone",
                        question: 'Had you gone?',
                        whQuestion: 'Where had you gone?',
                        russian: '—Ç—ã —É—à—ë–ª/—É—à–ª–∞ (–¥–æ —Ç–æ–≥–æ)'
                    },
                    'he': {
                        positive: 'he had gone',
                        negative: "he hadn't gone",
                        question: 'Had he gone?',
                        whQuestion: 'Where had he gone?',
                        russian: '–æ–Ω —É—à—ë–ª (–¥–æ —Ç–æ–≥–æ)'
                    },
                    'she': {
                        positive: 'she had gone',
                        negative: "she hadn't gone",
                        question: 'Had she gone?',
                        whQuestion: 'Where had she gone?',
                        russian: '–æ–Ω–∞ —É—à–ª–∞ (–¥–æ —Ç–æ–≥–æ)'
                    },
                    'it': {
                        positive: 'it had gone',
                        negative: "it hadn't gone",
                        question: 'Had it gone?',
                        whQuestion: 'Where had it gone?',
                        russian: '–æ–Ω–æ —É—à–ª–æ (–¥–æ —Ç–æ–≥–æ)'
                    },
                    'we': {
                        positive: 'we had gone',
                        negative: "we hadn't gone",
                        question: 'Had we gone?',
                        whQuestion: 'Where had we gone?',
                        russian: '–º—ã —É—à–ª–∏ (–¥–æ —Ç–æ–≥–æ)'
                    },
                    'they': {
                        positive: 'they had gone',
                        negative: "they hadn't gone",
                        question: 'Had they gone?',
                        whQuestion: 'Where had they gone?',
                        russian: '–æ–Ω–∏ —É—à–ª–∏ (–¥–æ —Ç–æ–≥–æ)'
                    }
                }
            },

            // DO verb
            'do': {
                present: {
                    'I': {
                        positive: 'I do',
                        negative: "I don't do",
                        question: 'Do I do?',
                        whQuestion: 'What do I do?',
                        russian: '–Ø –¥–µ–ª–∞—é'
                    },
                    'you': {
                        positive: 'you do',
                        negative: "you don't do",
                        question: 'Do you do?',
                        whQuestion: 'What do you do?',
                        russian: '—Ç—ã –¥–µ–ª–∞–µ—à—å'
                    },
                    'he': {
                        positive: 'he does',
                        negative: "he doesn't do",
                        question: 'Does he do?',
                        whQuestion: 'What does he do?',
                        russian: '–æ–Ω –¥–µ–ª–∞–µ—Ç'
                    },
                    'she': {
                        positive: 'she does',
                        negative: "she doesn't do",
                        question: 'Does she do?',
                        whQuestion: 'What does she do?',
                        russian: '–æ–Ω–∞ –¥–µ–ª–∞–µ—Ç'
                    },
                    'it': {
                        positive: 'it does',
                        negative: "it doesn't do",
                        question: 'Does it do?',
                        whQuestion: 'What does it do?',
                        russian: '–æ–Ω–æ –¥–µ–ª–∞–µ—Ç'
                    },
                    'we': {
                        positive: 'we do',
                        negative: "we don't do",
                        question: 'Do we do?',
                        whQuestion: 'What do we do?',
                        russian: '–º—ã –¥–µ–ª–∞–µ–º'
                    },
                    'they': {
                        positive: 'they do',
                        negative: "they don't do",
                        question: 'Do they do?',
                        whQuestion: 'What do they do?',
                        russian: '–æ–Ω–∏ –¥–µ–ª–∞—é—Ç'
                    }
                },
                past: {
                    'I': {
                        positive: 'I did',
                        negative: "I didn't do",
                        question: 'Did I do?',
                        whQuestion: 'What did I do?',
                        russian: '–Ø —Å–¥–µ–ª–∞–ª/—Å–¥–µ–ª–∞–ª–∞'
                    },
                    'you': {
                        positive: 'you did',
                        negative: "you didn't do",
                        question: 'Did you do?',
                        whQuestion: 'What did you do?',
                        russian: '—Ç—ã —Å–¥–µ–ª–∞–ª/—Å–¥–µ–ª–∞–ª–∞'
                    },
                    'he': {
                        positive: 'he did',
                        negative: "he didn't do",
                        question: 'Did he do?',
                        whQuestion: 'What did he do?',
                        russian: '–æ–Ω —Å–¥–µ–ª–∞–ª'
                    },
                    'she': {
                        positive: 'she did',
                        negative: "she didn't do",
                        question: 'Did she do?',
                        whQuestion: 'What did she do?',
                        russian: '–æ–Ω–∞ —Å–¥–µ–ª–∞–ª–∞'
                    },
                    'it': {
                        positive: 'it did',
                        negative: "it didn't do",
                        question: 'Did it do?',
                        whQuestion: 'What did it do?',
                        russian: '–æ–Ω–æ —Å–¥–µ–ª–∞–ª–æ'
                    },
                    'we': {
                        positive: 'we did',
                        negative: "we didn't do",
                        question: 'Did we do?',
                        whQuestion: 'What did we do?',
                        russian: '–º—ã —Å–¥–µ–ª–∞–ª–∏'
                    },
                    'they': {
                        positive: 'they did',
                        negative: "they didn't do",
                        question: 'Did they do?',
                        whQuestion: 'What did they do?',
                        russian: '–æ–Ω–∏ —Å–¥–µ–ª–∞–ª–∏'
                    }
                },
                future: {
                    'I': {
                        positive: 'I will do',
                        negative: "I won't do",
                        question: 'Will I do?',
                        whQuestion: 'What will I do?',
                        russian: '–Ø —Å–¥–µ–ª–∞—é'
                    },
                    'you': {
                        positive: 'you will do',
                        negative: "you won't do",
                        question: 'Will you do?',
                        whQuestion: 'What will you do?',
                        russian: '—Ç—ã —Å–¥–µ–ª–∞–µ—à—å'
                    },
                    'he': {
                        positive: 'he will do',
                        negative: "he won't do",
                        question: 'Will he do?',
                        whQuestion: 'What will he do?',
                        russian: '–æ–Ω —Å–¥–µ–ª–∞–µ—Ç'
                    },
                    'she': {
                        positive: 'she will do',
                        negative: "she won't do",
                        question: 'Will she do?',
                        whQuestion: 'What will she do?',
                        russian: '–æ–Ω–∞ —Å–¥–µ–ª–∞–µ—Ç'
                    },
                    'it': {
                        positive: 'it will do',
                        negative: "it won't do",
                        question: 'Will it do?',
                        whQuestion: 'What will it do?',
                        russian: '–æ–Ω–æ —Å–¥–µ–ª–∞–µ—Ç'
                    },
                    'we': {
                        positive: 'we will do',
                        negative: "we won't do",
                        question: 'Will we do?',
                        whQuestion: 'What will we do?',
                        russian: '–º—ã —Å–¥–µ–ª–∞–µ–º'
                    },
                    'they': {
                        positive: 'they will do',
                        negative: "they won't do",
                        question: 'Will they do?',
                        whQuestion: 'What will they do?',
                        russian: '–æ–Ω–∏ —Å–¥–µ–ª–∞—é—Ç'
                    }
                },
                presentPerfect: {
                    'I': {
                        positive: 'I have done',
                        negative: "I haven't done",
                        question: 'Have I done?',
                        whQuestion: 'What have I done?',
                        russian: '–Ø —Å–¥–µ–ª–∞–ª/—Å–¥–µ–ª–∞–ª–∞'
                    },
                    'you': {
                        positive: 'you have done',
                        negative: "you haven't done",
                        question: 'Have you done?',
                        whQuestion: 'What have you done?',
                        russian: '—Ç—ã —Å–¥–µ–ª–∞–ª/—Å–¥–µ–ª–∞–ª–∞'
                    },
                    'he': {
                        positive: 'he has done',
                        negative: "he hasn't done",
                        question: 'Has he done?',
                        whQuestion: 'What has he done?',
                        russian: '–æ–Ω —Å–¥–µ–ª–∞–ª'
                    },
                    'she': {
                        positive: 'she has done',
                        negative: "she hasn't done",
                        question: 'Has she done?',
                        whQuestion: 'What has she done?',
                        russian: '–æ–Ω–∞ —Å–¥–µ–ª–∞–ª–∞'
                    },
                    'it': {
                        positive: 'it has done',
                        negative: "it hasn't done",
                        question: 'Has it done?',
                        whQuestion: 'What has it done?',
                        russian: '–æ–Ω–æ —Å–¥–µ–ª–∞–ª–æ'
                    },
                    'we': {
                        positive: 'we have done',
                        negative: "we haven't done",
                        question: 'Have we done?',
                        whQuestion: 'What have we done?',
                        russian: '–º—ã —Å–¥–µ–ª–∞–ª–∏'
                    },
                    'they': {
                        positive: 'they have done',
                        negative: "they haven't done",
                        question: 'Have they done?',
                        whQuestion: 'What have they done?',
                        russian: '–æ–Ω–∏ —Å–¥–µ–ª–∞–ª–∏'
                    }
                },
                pastPerfect: {
                    'I': {
                        positive: 'I had done',
                        negative: "I hadn't done",
                        question: 'Had I done?',
                        whQuestion: 'What had I done?',
                        russian: '–Ø —Å–¥–µ–ª–∞–ª/—Å–¥–µ–ª–∞–ª–∞ (–¥–æ —Ç–æ–≥–æ)'
                    },
                    'you': {
                        positive: 'you had done',
                        negative: "you hadn't done",
                        question: 'Had you done?',
                        whQuestion: 'What had you done?',
                        russian: '—Ç—ã —Å–¥–µ–ª–∞–ª/—Å–¥–µ–ª–∞–ª–∞ (–¥–æ —Ç–æ–≥–æ)'
                    },
                    'he': {
                        positive: 'he had done',
                        negative: "he hadn't done",
                        question: 'Had he done?',
                        whQuestion: 'What had he done?',
                        russian: '–æ–Ω —Å–¥–µ–ª–∞–ª (–¥–æ —Ç–æ–≥–æ)'
                    },
                    'she': {
                        positive: 'she had done',
                        negative: "she hadn't done",
                        question: 'Had she done?',
                        whQuestion: 'What had she done?',
                        russian: '–æ–Ω–∞ —Å–¥–µ–ª–∞–ª–∞ (–¥–æ —Ç–æ–≥–æ)'
                    },
                    'it': {
                        positive: 'it had done',
                        negative: "it hadn't done",
                        question: 'Had it done?',
                        whQuestion: 'What had it done?',
                        russian: '–æ–Ω–æ —Å–¥–µ–ª–∞–ª–æ (–¥–æ —Ç–æ–≥–æ)'
                    },
                    'we': {
                        positive: 'we had done',
                        negative: "we hadn't done",
                        question: 'Had we done?',
                        whQuestion: 'What had we done?',
                        russian: '–º—ã —Å–¥–µ–ª–∞–ª–∏ (–¥–æ —Ç–æ–≥–æ)'
                    },
                    'they': {
                        positive: 'they had done',
                        negative: "they hadn't done",
                        question: 'Had they done?',
                        whQuestion: 'What had they done?',
                        russian: '–æ–Ω–∏ —Å–¥–µ–ª–∞–ª–∏ (–¥–æ —Ç–æ–≥–æ)'
                    }
                }
            },

            // HAVE verb
            'have': {
                present: {
                    'I': {
                        positive: 'I have',
                        negative: "I don't have",
                        question: 'Do I have?',
                        whQuestion: 'What do I have?',
                        russian: '–Ø –∏–º–µ—é'
                    },
                    'you': {
                        positive: 'you have',
                        negative: "you don't have",
                        question: 'Do you have?',
                        whQuestion: 'What do you have?',
                        russian: '—Ç—ã –∏–º–µ–µ—à—å'
                    },
                    'he': {
                        positive: 'he has',
                        negative: "he doesn't have",
                        question: 'Does he have?',
                        whQuestion: 'What does he have?',
                        russian: '–æ–Ω –∏–º–µ–µ—Ç'
                    },
                    'she': {
                        positive: 'she has',
                        negative: "she doesn't have",
                        question: 'Does she have?',
                        whQuestion: 'What does she have?',
                        russian: '–æ–Ω–∞ –∏–º–µ–µ—Ç'
                    },
                    'it': {
                        positive: 'it has',
                        negative: "it doesn't have",
                        question: 'Does it have?',
                        whQuestion: 'What does it have?',
                        russian: '–æ–Ω–æ –∏–º–µ–µ—Ç'
                    },
                    'we': {
                        positive: 'we have',
                        negative: "we don't have",
                        question: 'Do we have?',
                        whQuestion: 'What do we have?',
                        russian: '–º—ã –∏–º–µ–µ–º'
                    },
                    'they': {
                        positive: 'they have',
                        negative: "they don't have",
                        question: 'Do they have?',
                        whQuestion: 'What do they have?',
                        russian: '–æ–Ω–∏ –∏–º–µ—é—Ç'
                    }
                },
                past: {
                    'I': {
                        positive: 'I had',
                        negative: "I didn't have",
                        question: 'Did I have?',
                        whQuestion: 'What did I have?',
                        russian: '–Ø –∏–º–µ–ª/–∏–º–µ–ª–∞'
                    },
                    'you': {
                        positive: 'you had',
                        negative: "you didn't have",
                        question: 'Did you have?',
                        whQuestion: 'What did you have?',
                        russian: '—Ç—ã –∏–º–µ–ª/–∏–º–µ–ª–∞'
                    },
                    'he': {
                        positive: 'he had',
                        negative: "he didn't have",
                        question: 'Did he have?',
                        whQuestion: 'What did he have?',
                        russian: '–æ–Ω –∏–º–µ–ª'
                    },
                    'she': {
                        positive: 'she had',
                        negative: "she didn't have",
                        question: 'Did she have?',
                        whQuestion: 'What did she have?',
                        russian: '–æ–Ω–∞ –∏–º–µ–ª–∞'
                    },
                    'it': {
                        positive: 'it had',
                        negative: "it didn't have",
                        question: 'Did it have?',
                        whQuestion: 'What did it have?',
                        russian: '–æ–Ω–æ –∏–º–µ–ª–æ'
                    },
                    'we': {
                        positive: 'we had',
                        negative: "we didn't have",
                        question: 'Did we have?',
                        whQuestion: 'What did we have?',
                        russian: '–º—ã –∏–º–µ–ª–∏'
                    },
                    'they': {
                        positive: 'they had',
                        negative: "they didn't have",
                        question: 'Did they have?',
                        whQuestion: 'What did they have?',
                        russian: '–æ–Ω–∏ –∏–º–µ–ª–∏'
                    }
                },
                future: {
                    'I': {
                        positive: 'I will have',
                        negative: "I won't have",
                        question: 'Will I have?',
                        whQuestion: 'What will I have?',
                        russian: '–Ø –±—É–¥—É –∏–º–µ—Ç—å'
                    },
                    'you': {
                        positive: 'you will have',
                        negative: "you won't have",
                        question: 'Will you have?',
                        whQuestion: 'What will you have?',
                        russian: '—Ç—ã –±—É–¥–µ—à—å –∏–º–µ—Ç—å'
                    },
                    'he': {
                        positive: 'he will have',
                        negative: "he won't have",
                        question: 'Will he have?',
                        whQuestion: 'What will he have?',
                        russian: '–æ–Ω –±—É–¥–µ—Ç –∏–º–µ—Ç—å'
                    },
                    'she': {
                        positive: 'she will have',
                        negative: "she won't have",
                        question: 'Will she have?',
                        whQuestion: 'What will she have?',
                        russian: '–æ–Ω–∞ –±—É–¥–µ—Ç –∏–º–µ—Ç—å'
                    },
                    'it': {
                        positive: 'it will have',
                        negative: "it won't have",
                        question: 'Will it have?',
                        whQuestion: 'What will it have?',
                        russian: '–æ–Ω–æ –±—É–¥–µ—Ç –∏–º–µ—Ç—å'
                    },
                    'we': {
                        positive: 'we will have',
                        negative: "we won't have",
                        question: 'Will we have?',
                        whQuestion: 'What will we have?',
                        russian: '–º—ã –±—É–¥–µ–º –∏–º–µ—Ç—å'
                    },
                    'they': {
                        positive: 'they will have',
                        negative: "they won't have",
                        question: 'Will they have?',
                        whQuestion: 'What will they have?',
                        russian: '–æ–Ω–∏ –±—É–¥—É—Ç –∏–º–µ—Ç—å'
                    }
                },
                presentPerfect: {
                    'I': {
                        positive: 'I have had',
                        negative: "I haven't had",
                        question: 'Have I had?',
                        whQuestion: 'What have I had?',
                        russian: '–Ø –∏–º–µ–ª/–∏–º–µ–ª–∞'
                    },
                    'you': {
                        positive: 'you have had',
                        negative: "you haven't had",
                        question: 'Have you had?',
                        whQuestion: 'What have you had?',
                        russian: '—Ç—ã –∏–º–µ–ª/–∏–º–µ–ª–∞'
                    },
                    'he': {
                        positive: 'he has had',
                        negative: "he hasn't had",
                        question: 'Has he had?',
                        whQuestion: 'What has he had?',
                        russian: '–æ–Ω –∏–º–µ–ª'
                    },
                    'she': {
                        positive: 'she has had',
                        negative: "she hasn't had",
                        question: 'Has she had?',
                        whQuestion: 'What has she had?',
                        russian: '–æ–Ω–∞ –∏–º–µ–ª–∞'
                    },
                    'it': {
                        positive: 'it has had',
                        negative: "it hasn't had",
                        question: 'Has it had?',
                        whQuestion: 'What has it had?',
                        russian: '–æ–Ω–æ –∏–º–µ–ª–æ'
                    },
                    'we': {
                        positive: 'we have had',
                        negative: "we haven't had",
                        question: 'Have we had?',
                        whQuestion: 'What have we had?',
                        russian: '–º—ã –∏–º–µ–ª–∏'
                    },
                    'they': {
                        positive: 'they have had',
                        negative: "they haven't had",
                        question: 'Have they had?',
                        whQuestion: 'What have they had?',
                        russian: '–æ–Ω–∏ –∏–º–µ–ª–∏'
                    }
                },
                pastPerfect: {
                    'I': {
                        positive: 'I had had',
                        negative: "I hadn't had",
                        question: 'Had I had?',
                        whQuestion: 'What had I had?',
                        russian: '–Ø –∏–º–µ–ª/–∏–º–µ–ª–∞ (–¥–æ —Ç–æ–≥–æ)'
                    },
                    'you': {
                        positive: 'you had had',
                        negative: "you hadn't had",
                        question: 'Had you had?',
                        whQuestion: 'What had you had?',
                        russian: '—Ç—ã –∏–º–µ–ª/–∏–º–µ–ª–∞ (–¥–æ —Ç–æ–≥–æ)'
                    },
                    'he': {
                        positive: 'he had had',
                        negative: "he hadn't had",
                        question: 'Had he had?',
                        whQuestion: 'What had he had?',
                        russian: '–æ–Ω –∏–º–µ–ª (–¥–æ —Ç–æ–≥–æ)'
                    },
                    'she': {
                        positive: 'she had had',
                        negative: "she hadn't had",
                        question: 'Had she had?',
                        whQuestion: 'What had she had?',
                        russian: '–æ–Ω–∞ –∏–º–µ–ª–∞ (–¥–æ —Ç–æ–≥–æ)'
                    },
                    'it': {
                        positive: 'it had had',
                        negative: "it hadn't had",
                        question: 'Had it had?',
                        whQuestion: 'What had it had?',
                        russian: '–æ–Ω–æ –∏–º–µ–ª–æ (–¥–æ —Ç–æ–≥–æ)'
                    },
                    'we': {
                        positive: 'we had had',
                        negative: "we hadn't had",
                        question: 'Had we had?',
                        whQuestion: 'What had we had?',
                        russian: '–º—ã –∏–º–µ–ª–∏ (–¥–æ —Ç–æ–≥–æ)'
                    },
                    'they': {
                        positive: 'they had had',
                        negative: "they hadn't had",
                        question: 'Had they had?',
                        whQuestion: 'What had they had?',
                        russian: '–æ–Ω–∏ –∏–º–µ–ª–∏ (–¥–æ —Ç–æ–≥–æ)'
                    }
                }
            },

            // SEE verb
            'see': {
                present: {
                    'I': {
                        positive: 'I see',
                        negative: "I don't see",
                        question: 'Do I see?',
                        whQuestion: 'What do I see?',
                        russian: '–Ø –≤–∏–∂—É'
                    },
                    'you': {
                        positive: 'you see',
                        negative: "you don't see",
                        question: 'Do you see?',
                        whQuestion: 'What do you see?',
                        russian: '—Ç—ã –≤–∏–¥–∏—à—å'
                    },
                    'he': {
                        positive: 'he sees',
                        negative: "he doesn't see",
                        question: 'Does he see?',
                        whQuestion: 'What does he see?',
                        russian: '–æ–Ω –≤–∏–¥–∏—Ç'
                    },
                    'she': {
                        positive: 'she sees',
                        negative: "she doesn't see",
                        question: 'Does she see?',
                        whQuestion: 'What does she see?',
                        russian: '–æ–Ω–∞ –≤–∏–¥–∏—Ç'
                    },
                    'it': {
                        positive: 'it sees',
                        negative: "it doesn't see",
                        question: 'Does it see?',
                        whQuestion: 'What does it see?',
                        russian: '–æ–Ω–æ –≤–∏–¥–∏—Ç'
                    },
                    'we': {
                        positive: 'we see',
                        negative: "we don't see",
                        question: 'Do we see?',
                        whQuestion: 'What do we see?',
                        russian: '–º—ã –≤–∏–¥–∏–º'
                    },
                    'they': {
                        positive: 'they see',
                        negative: "they don't see",
                        question: 'Do they see?',
                        whQuestion: 'What do they see?',
                        russian: '–æ–Ω–∏ –≤–∏–¥—è—Ç'
                    }
                },
                past: {
                    'I': {
                        positive: 'I saw',
                        negative: "I didn't see",
                        question: 'Did I see?',
                        whQuestion: 'What did I see?',
                        russian: '–Ø –≤–∏–¥–µ–ª/–≤–∏–¥–µ–ª–∞'
                    },
                    'you': {
                        positive: 'you saw',
                        negative: "you didn't see",
                        question: 'Did you see?',
                        whQuestion: 'What did you see?',
                        russian: '—Ç—ã –≤–∏–¥–µ–ª/–≤–∏–¥–µ–ª–∞'
                    },
                    'he': {
                        positive: 'he saw',
                        negative: "he didn't see",
                        question: 'Did he see?',
                        whQuestion: 'What did he see?',
                        russian: '–æ–Ω –≤–∏–¥–µ–ª'
                    },
                    'she': {
                        positive: 'she saw',
                        negative: "she didn't see",
                        question: 'Did she see?',
                        whQuestion: 'What did she see?',
                        russian: '–æ–Ω–∞ –≤–∏–¥–µ–ª–∞'
                    },
                    'it': {
                        positive: 'it saw',
                        negative: "it didn't see",
                        question: 'Did it see?',
                        whQuestion: 'What did it see?',
                        russian: '–æ–Ω–æ –≤–∏–¥–µ–ª–æ'
                    },
                    'we': {
                        positive: 'we saw',
                        negative: "we didn't see",
                        question: 'Did we see?',
                        whQuestion: 'What did we see?',
                        russian: '–º—ã –≤–∏–¥–µ–ª–∏'
                    },
                    'they': {
                        positive: 'they saw',
                        negative: "they didn't see",
                        question: 'Did they see?',
                        whQuestion: 'What did they see?',
                        russian: '–æ–Ω–∏ –≤–∏–¥–µ–ª–∏'
                    }
                },
                future: {
                    'I': {
                        positive: 'I will see',
                        negative: "I won't see",
                        question: 'Will I see?',
                        whQuestion: 'What will I see?',
                        russian: '–Ø —É–≤–∏–∂—É'
                    },
                    'you': {
                        positive: 'you will see',
                        negative: "you won't see",
                        question: 'Will you see?',
                        whQuestion: 'What will you see?',
                        russian: '—Ç—ã —É–≤–∏–¥–∏—à—å'
                    },
                    'he': {
                        positive: 'he will see',
                        negative: "he won't see",
                        question: 'Will he see?',
                        whQuestion: 'What will he see?',
                        russian: '–æ–Ω —É–≤–∏–¥–∏—Ç'
                    },
                    'she': {
                        positive: 'she will see',
                        negative: "she won't see",
                        question: 'Will she see?',
                        whQuestion: 'What will she see?',
                        russian: '–æ–Ω–∞ —É–≤–∏–¥–∏—Ç'
                    },
                    'it': {
                        positive: 'it will see',
                        negative: "it won't see",
                        question: 'Will it see?',
                        whQuestion: 'What will it see?',
                        russian: '–æ–Ω–æ —É–≤–∏–¥–∏—Ç'
                    },
                    'we': {
                        positive: 'we will see',
                        negative: "we won't see",
                        question: 'Will we see?',
                        whQuestion: 'What will we see?',
                        russian: '–º—ã —É–≤–∏–¥–∏–º'
                    },
                    'they': {
                        positive: 'they will see',
                        negative: "they won't see",
                        question: 'Will they see?',
                        whQuestion: 'What will they see?',
                        russian: '–æ–Ω–∏ —É–≤–∏–¥—è—Ç'
                    }
                },
                presentPerfect: {
                    'I': {
                        positive: 'I have seen',
                        negative: "I haven't seen",
                        question: 'Have I seen?',
                        whQuestion: 'What have I seen?',
                        russian: '–Ø –≤–∏–¥–µ–ª/–≤–∏–¥–µ–ª–∞'
                    },
                    'you': {
                        positive: 'you have seen',
                        negative: "you haven't seen",
                        question: 'Have you seen?',
                        whQuestion: 'What have you seen?',
                        russian: '—Ç—ã –≤–∏–¥–µ–ª/–≤–∏–¥–µ–ª–∞'
                    },
                    'he': {
                        positive: 'he has seen',
                        negative: "he hasn't seen",
                        question: 'Has he seen?',
                        whQuestion: 'What has he seen?',
                        russian: '–æ–Ω –≤–∏–¥–µ–ª'
                    },
                    'she': {
                        positive: 'she has seen',
                        negative: "she hasn't seen",
                        question: 'Has she seen?',
                        whQuestion: 'What has she seen?',
                        russian: '–æ–Ω–∞ –≤–∏–¥–µ–ª–∞'
                    },
                    'it': {
                        positive: 'it has seen',
                        negative: "it hasn't seen",
                        question: 'Has it seen?',
                        whQuestion: 'What has it seen?',
                        russian: '–æ–Ω–æ –≤–∏–¥–µ–ª–æ'
                    },
                    'we': {
                        positive: 'we have seen',
                        negative: "we haven't seen",
                        question: 'Have we seen?',
                        whQuestion: 'What have we seen?',
                        russian: '–º—ã –≤–∏–¥–µ–ª–∏'
                    },
                    'they': {
                        positive: 'they have seen',
                        negative: "they haven't seen",
                        question: 'Have they seen?',
                        whQuestion: 'What have they seen?',
                        russian: '–æ–Ω–∏ –≤–∏–¥–µ–ª–∏'
                    }
                },
                pastPerfect: {
                    'I': {
                        positive: 'I had seen',
                        negative: "I hadn't seen",
                        question: 'Had I seen?',
                        whQuestion: 'What had I seen?',
                        russian: '–Ø –≤–∏–¥–µ–ª/–≤–∏–¥–µ–ª–∞ (–¥–æ —Ç–æ–≥–æ)'
                    },
                    'you': {
                        positive: 'you had seen',
                        negative: "you hadn't seen",
                        question: 'Had you seen?',
                        whQuestion: 'What had you seen?',
                        russian: '—Ç—ã –≤–∏–¥–µ–ª/–≤–∏–¥–µ–ª–∞ (–¥–æ —Ç–æ–≥–æ)'
                    },
                    'he': {
                        positive: 'he had seen',
                        negative: "he hadn't seen",
                        question: 'Had he seen?',
                        whQuestion: 'What had he seen?',
                        russian: '–æ–Ω –≤–∏–¥–µ–ª (–¥–æ —Ç–æ–≥–æ)'
                    },
                    'she': {
                        positive: 'she had seen',
                        negative: "she hadn't seen",
                        question: 'Had she seen?',
                        whQuestion: 'What had she seen?',
                        russian: '–æ–Ω–∞ –≤–∏–¥–µ–ª–∞ (–¥–æ —Ç–æ–≥–æ)'
                    },
                    'it': {
                        positive: 'it had seen',
                        negative: "it hadn't seen",
                        question: 'Had it seen?',
                        whQuestion: 'What had it seen?',
                        russian: '–æ–Ω–æ –≤–∏–¥–µ–ª–æ (–¥–æ —Ç–æ–≥–æ)'
                    },
                    'we': {
                        positive: 'we had seen',
                        negative: "we hadn't seen",
                        question: 'Had we seen?',
                        whQuestion: 'What had we seen?',
                        russian: '–º—ã –≤–∏–¥–µ–ª–∏ (–¥–æ —Ç–æ–≥–æ)'
                    },
                    'they': {
                        positive: 'they had seen',
                        negative: "they hadn't seen",
                        question: 'Had they seen?',
                        whQuestion: 'What had they seen?',
                        russian: '–æ–Ω–∏ –≤–∏–¥–µ–ª–∏ (–¥–æ —Ç–æ–≥–æ)'
                    }
                }
            }
        };

        // Add Present Perfect and Past Perfect to all other verbs
        const verbsToUpdate = Object.keys(verbDictionary);
        
        verbsToUpdate.forEach(verb => {
            // Skip verbs that already have perfect tenses
            if (!verbDictionary[verb].presentPerfect) {
                // Determine past participle form
                let pastParticiple;
                const irregularParticiples = {
                    'beat': 'beaten',
                    'become': 'become',
                    'begin': 'begun',
                    'break': 'broken',
                    'bring': 'brought',
                    'build': 'built',
                    'buy': 'bought',
                    'catch': 'caught',
                    'choose': 'chosen',
                    'come': 'come',
                    'cost': 'cost',
                    'draw': 'drawn',
                    'dream': 'dreamt',
                    'drink': 'drunk',
                    'drive': 'driven',
                    'eat': 'eaten',
                    'fall': 'fallen',
                    'feel': 'felt',
                    'find': 'found',
                    'fly': 'flown',
                    'get': 'got',
                    'give': 'given',
                    'grow': 'grown',
                    'hear': 'heard',
                    'know': 'known',
                    'learn': 'learnt',
                    'leave': 'left',
                    'lie': 'lain',
                    'make': 'made',
                    'meet': 'met',
                    'put': 'put',
                    'read': 'read',
                    'run': 'run',
                    'say': 'said',
                    'seek': 'sought',
                    'show': 'shown',
                    'sing': 'sung',
                    'sit': 'sat',
                    'sleep': 'slept',
                    'speak': 'spoken',
                    'stand': 'stood',
                    'swim': 'swum',
                    'take': 'taken',
                    'teach': 'taught',
                    'tell': 'told',
                    'think': 'thought',
                    'throw': 'thrown',
                    'understand': 'understood',
                    'write': 'written',
                    'fix': 'fixed',
                    'play': 'played',
                    'study': 'studied',
                    'work': 'worked',
                    'cry': 'cried'
                };
                
                pastParticiple = irregularParticiples[verb] || verb + 'ed';
                
                // Add Present Perfect
                verbDictionary[verb].presentPerfect = {
                    'I': {
                        positive: `I have ${pastParticiple}`,
                        negative: `I haven't ${pastParticiple}`,
                        question: `Have I ${pastParticiple}?`,
                        whQuestion: `What have I ${pastParticiple}?`,
                        russian: verbDictionary[verb].past['I'].russian
                    },
                    'you': {
                        positive: `you have ${pastParticiple}`,
                        negative: `you haven't ${pastParticiple}`,
                        question: `Have you ${pastParticiple}?`,
                        whQuestion: `What have you ${pastParticiple}?`,
                        russian: verbDictionary[verb].past['you'].russian
                    },
                    'he': {
                        positive: `he has ${pastParticiple}`,
                        negative: `he hasn't ${pastParticiple}`,
                        question: `Has he ${pastParticiple}?`,
                        whQuestion: `What has he ${pastParticiple}?`,
                        russian: verbDictionary[verb].past['he'].russian
                    },
                    'she': {
                        positive: `she has ${pastParticiple}`,
                        negative: `she hasn't ${pastParticiple}`,
                        question: `Has she ${pastParticiple}?`,
                        whQuestion: `What has she ${pastParticiple}?`,
                        russian: verbDictionary[verb].past['she'].russian
                    },
                    'it': {
                        positive: `it has ${pastParticiple}`,
                        negative: `it hasn't ${pastParticiple}`,
                        question: `Has it ${pastParticiple}?`,
                        whQuestion: `What has it ${pastParticiple}?`,
                        russian: verbDictionary[verb].past['it'].russian
                    },
                    'we': {
                        positive: `we have ${pastParticiple}`,
                        negative: `we haven't ${pastParticiple}`,
                        question: `Have we ${pastParticiple}?`,
                        whQuestion: `What have we ${pastParticiple}?`,
                        russian: verbDictionary[verb].past['we'].russian
                    },
                    'they': {
                        positive: `they have ${pastParticiple}`,
                        negative: `they haven't ${pastParticiple}`,
                        question: `Have they ${pastParticiple}?`,
                        whQuestion: `What have they ${pastParticiple}?`,
                        russian: verbDictionary[verb].past['they'].russian
                    }
                };
                
                // Add Past Perfect
                verbDictionary[verb].pastPerfect = {
                    'I': {
                        positive: `I had ${pastParticiple}`,
                        negative: `I hadn't ${pastParticiple}`,
                        question: `Had I ${pastParticiple}?`,
                        whQuestion: `What had I ${pastParticiple}?`,
                        russian: verbDictionary[verb].past['I'].russian.replace(/\./g, '') + ' (–¥–æ —Ç–æ–≥–æ)'
                    },
                    'you': {
                        positive: `you had ${pastParticiple}`,
                        negative: `you hadn't ${pastParticiple}`,
                        question: `Had you ${pastParticiple}?`,
                        whQuestion: `What had you ${pastParticiple}?`,
                        russian: verbDictionary[verb].past['you'].russian.replace(/\./g, '') + ' (–¥–æ —Ç–æ–≥–æ)'
                    },
                    'he': {
                        positive: `he had ${pastParticiple}`,
                        negative: `he hadn't ${pastParticiple}`,
                        question: `Had he ${pastParticiple}?`,
                        whQuestion: `What had he ${pastParticiple}?`,
                        russian: verbDictionary[verb].past['he'].russian.replace(/\./g, '') + ' (–¥–æ —Ç–æ–≥–æ)'
                    },
                    'she': {
                        positive: `she had ${pastParticiple}`,
                        negative: `she hadn't ${pastParticiple}`,
                        question: `Had she ${pastParticiple}?`,
                        whQuestion: `What had she ${pastParticiple}?`,
                        russian: verbDictionary[verb].past['she'].russian.replace(/\./g, '') + ' (–¥–æ —Ç–æ–≥–æ)'
                    },
                    'it': {
                        positive: `it had ${pastParticiple}`,
                        negative: `it hadn't ${pastParticiple}`,
                        question: `Had it ${pastParticiple}?`,
                        whQuestion: `What had it ${pastParticiple}?`,
                        russian: verbDictionary[verb].past['it'].russian.replace(/\./g, '') + ' (–¥–æ —Ç–æ–≥–æ)'
                    },
                    'we': {
                        positive: `we had ${pastParticiple}`,
                        negative: `we hadn't ${pastParticiple}`,
                        question: `Had we ${pastParticiple}?`,
                        whQuestion: `What had we ${pastParticiple}?`,
                        russian: verbDictionary[verb].past['we'].russian.replace(/\./g, '') + ' (–¥–æ —Ç–æ–≥–æ)'
                    },
                    'they': {
                        positive: `they had ${pastParticiple}`,
                        negative: `they hadn't ${pastParticiple}`,
                        question: `Had they ${pastParticiple}?`,
                        whQuestion: `What had they ${pastParticiple}?`,
                        russian: verbDictionary[verb].past['they'].russian.replace(/\./g, '') + ' (–¥–æ —Ç–æ–≥–æ)'
                    }
                };
            }
        });

        // Create a list of all available verbs
        const verbs = Object.keys(verbDictionary);
        
        // Data
        const allSubjects = ['I', 'you', 'he', 'she', 'it', 'we', 'they'];

        // State
        let currentVerb = 'go';
        let currentSubjectIndex = 0;
        let isLoading = false;
        
        // State for Past Simple
        let currentVerbPast = 'go';
        let currentSubjectIndexPast = 0;
        
        // State for Future Simple
        let currentVerbFuture = 'go';
        let currentSubjectIndexFuture = 0;
        
        // State for Present Perfect
        let currentVerbPresentPerfect = 'go';
        let currentSubjectIndexPresentPerfect = 0;
        
        // State for Past Perfect
        let currentVerbPastPerfect = 'go';
        let currentSubjectIndexPastPerfect = 0;
        
        // Audio settings
        let audioEnabled = true;
        
        // Test Yourself state
        let currentTestData = null;
        let revealStage = 0;

        // Navigation functions
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.add('hidden');
            });
            document.getElementById(screenId).classList.remove('hidden');
        }

        function showMainMenu() {
            showScreen('mainMenu');
        }

        function showExercises() {
            showScreen('exercisesMenu');
        }

        function showTestYourself() {
            showScreen('testYourself');
            // Ensure proper initial state
            document.getElementById('russianSentence').style.display = 'block';
            document.querySelectorAll('.english').forEach(el => {
                el.style.display = 'none';
            });
            generateNewTest();
        }

        function startPresentSimple() {
            showScreen('presentSimple');
            currentSubjectIndex = 0;
            updateExerciseDisplay();
        }

        function startPastSimple() {
            showScreen('pastSimple');
            currentSubjectIndexPast = 0;
            updatePastSimpleDisplay();
        }

        function startFutureSimple() {
            showScreen('futureSimple');
            currentSubjectIndexFuture = 0;
            updateFutureSimpleDisplay();
        }

        function startPresentPerfect() {
            showScreen('presentPerfect');
            currentSubjectIndexPresentPerfect = 0;
            updatePresentPerfectDisplay();
        }

        function startPastPerfect() {
            showScreen('pastPerfect');
            currentSubjectIndexPastPerfect = 0;
            updatePastPerfectDisplay();
        }

        // Present Perfect Exercise Functions
        function updatePresentPerfectDisplay() {
            if (isLoading) return;
            
            const subject = allSubjects[currentSubjectIndexPresentPerfect];
            
            try {
                // Get verb data from dictionary
                const verbData = verbDictionary[currentVerbPresentPerfect]?.presentPerfect?.[subject];
                
                if (verbData) {
                    document.getElementById('sentencePresentPerfect1').textContent = verbData.positive;
                    document.getElementById('sentencePresentPerfect2').textContent = verbData.negative;
                    document.getElementById('sentencePresentPerfect3').textContent = verbData.question;
                    document.getElementById('sentencePresentPerfect4').textContent = verbData.whQuestion;
                    
                    // Update scheme info
                    const hasForm = ['he', 'she', 'it'].includes(subject) ? 'has' : 'have';
                    document.getElementById('schemeInfoPresentPerfect').textContent = 
                        `Present Perfect: ${hasForm} + past participle`;
                }
                
            } catch (error) {
                console.error('Error:', error);
            }
            
            // Update verb info
            document.getElementById('currentVerbPresentPerfect').textContent = `Current verb: ${currentVerbPresentPerfect}`;
        }

        function nextSubjectPresentPerfect() {
            if (!isLoading) {
                currentSubjectIndexPresentPerfect++;
                if (currentSubjectIndexPresentPerfect >= allSubjects.length) {
                    currentSubjectIndexPresentPerfect = 0;
                }
                updatePresentPerfectDisplay();
            }
        }

        function previousSubjectPresentPerfect() {
            if (!isLoading) {
                currentSubjectIndexPresentPerfect--;
                if (currentSubjectIndexPresentPerfect < 0) {
                    currentSubjectIndexPresentPerfect = allSubjects.length - 1;
                }
                updatePresentPerfectDisplay();
            }
        }

        function changeVerbPresentPerfect() {
            if (isLoading) return;
            
            let newVerb;
            do {
                newVerb = verbs[Math.floor(Math.random() * verbs.length)];
            } while (newVerb === currentVerbPresentPerfect);
            
            currentVerbPresentPerfect = newVerb;
            currentSubjectIndexPresentPerfect = Math.floor(Math.random() * allSubjects.length);
            
            updatePresentPerfectDisplay();
        }

        // Past Perfect Exercise Functions
        function updatePastPerfectDisplay() {
            if (isLoading) return;
            
            const subject = allSubjects[currentSubjectIndexPastPerfect];
            
            try {
                // Get verb data from dictionary
                const verbData = verbDictionary[currentVerbPastPerfect]?.pastPerfect?.[subject];
                
                if (verbData) {
                    document.getElementById('sentencePastPerfect1').textContent = verbData.positive;
                    document.getElementById('sentencePastPerfect2').textContent = verbData.negative;
                    document.getElementById('sentencePastPerfect3').textContent = verbData.question;
                    document.getElementById('sentencePastPerfect4').textContent = verbData.whQuestion;
                    document.getElementById('schemeInfoPastPerfect').textContent = 
                        'Past Perfect: had + past participle for all subjects';
                }
                
            } catch (error) {
                console.error('Error:', error);
            }
            
            // Update verb info
            document.getElementById('currentVerbPastPerfect').textContent = `Current verb: ${currentVerbPastPerfect}`;
        }

        function nextSubjectPastPerfect() {
            if (!isLoading) {
                currentSubjectIndexPastPerfect++;
                if (currentSubjectIndexPastPerfect >= allSubjects.length) {
                    currentSubjectIndexPastPerfect = 0;
                }
                updatePastPerfectDisplay();
            }
        }

        function previousSubjectPastPerfect() {
            if (!isLoading) {
                currentSubjectIndexPastPerfect--;
                if (currentSubjectIndexPastPerfect < 0) {
                    currentSubjectIndexPastPerfect = allSubjects.length - 1;
                }
                updatePastPerfectDisplay();
            }
        }

        function changeVerbPastPerfect() {
            if (isLoading) return;
            
            let newVerb;
            do {
                newVerb = verbs[Math.floor(Math.random() * verbs.length)];
            } while (newVerb === currentVerbPastPerfect);
            
            currentVerbPastPerfect = newVerb;
            currentSubjectIndexPastPerfect = Math.floor(Math.random() * allSubjects.length);
            
            updatePastPerfectDisplay();
        }

        // Future Simple Exercise Functions
        function updateFutureSimpleDisplay() {
            if (isLoading) return;
            
            const subject = allSubjects[currentSubjectIndexFuture];
            
            try {
                // Get verb data from dictionary
                const verbData = verbDictionary[currentVerbFuture]?.future?.[subject];
                
                if (verbData) {
                    document.getElementById('sentenceFuture1').textContent = verbData.positive;
                    document.getElementById('sentenceFuture2').textContent = verbData.negative;
                    document.getElementById('sentenceFuture3').textContent = verbData.question;
                    document.getElementById('sentenceFuture4').textContent = verbData.whQuestion;
                    document.getElementById('schemeInfoFuture').textContent = 'Future Simple: will + base verb for all subjects';
                }
                
            } catch (error) {
                console.error('Error:', error);
            }
            
            // Update verb info
            document.getElementById('currentVerbFuture').textContent = `Current verb: ${currentVerbFuture}`;
        }

        function nextSubjectFuture() {
            if (!isLoading) {
                currentSubjectIndexFuture++;
                if (currentSubjectIndexFuture >= allSubjects.length) {
                    currentSubjectIndexFuture = 0; // Loop back to beginning
                }
                updateFutureSimpleDisplay();
            }
        }

        function previousSubjectFuture() {
            if (!isLoading) {
                currentSubjectIndexFuture--;
                if (currentSubjectIndexFuture < 0) {
                    currentSubjectIndexFuture = allSubjects.length - 1; // Loop to end
                }
                updateFutureSimpleDisplay();
            }
        }

        function changeVerbFuture() {
            if (isLoading) return;
            
            // Get a random verb different from the current one
            let newVerb;
            do {
                newVerb = verbs[Math.floor(Math.random() * verbs.length)];
            } while (newVerb === currentVerbFuture);
            
            currentVerbFuture = newVerb;
            
            // Get a random subject
            currentSubjectIndexFuture = Math.floor(Math.random() * allSubjects.length);
            
            updateFutureSimpleDisplay();
        }

        // Present Simple Exercise Functions
        function updateExerciseDisplay() {
            if (isLoading) return;
            
            const subject = allSubjects[currentSubjectIndex];
            
            try {
                // Get verb data from dictionary
                const verbData = verbDictionary[currentVerb]?.present?.[subject];
                
                if (verbData) {
                    document.getElementById('sentence1').textContent = verbData.positive;
                    document.getElementById('sentence2').textContent = verbData.negative;
                    document.getElementById('sentence3').textContent = verbData.question;
                    document.getElementById('sentence4').textContent = verbData.whQuestion;
                    
                    // Update scheme info
                    const isThirdPerson = ['he', 'she', 'it'].includes(subject);
                    document.getElementById('schemeInfo').textContent = isThirdPerson ? 
                        'Scheme 2: he/she/it forms (third person singular)' : 
                        'Scheme 1: I/you/we/they forms';
                }
                
            } catch (error) {
                console.error('Error:', error);
            }
            
            // Update verb info
            document.getElementById('currentVerb').textContent = `Current verb: ${currentVerb}`;
        }

        function nextSubject() {
            if (!isLoading) {
                currentSubjectIndex++;
                if (currentSubjectIndex >= allSubjects.length) {
                    currentSubjectIndex = 0; // Loop back to beginning
                }
                updateExerciseDisplay();
            }
        }

        function previousSubject() {
            if (!isLoading) {
                currentSubjectIndex--;
                if (currentSubjectIndex < 0) {
                    currentSubjectIndex = allSubjects.length - 1; // Loop to end
                }
                updateExerciseDisplay();
            }
        }

        function changeVerb() {
            if (isLoading) return;
            
            // Get a random verb different from the current one
            let newVerb;
            do {
                newVerb = verbs[Math.floor(Math.random() * verbs.length)];
            } while (newVerb === currentVerb);
            
            currentVerb = newVerb;
            
            // Get a random subject
            currentSubjectIndex = Math.floor(Math.random() * allSubjects.length);
            
            updateExerciseDisplay();
        }

        // Past Simple Exercise Functions
        function updatePastSimpleDisplay() {
            if (isLoading) return;
            
            const subject = allSubjects[currentSubjectIndexPast];
            
            try {
                // Get verb data from dictionary
                const verbData = verbDictionary[currentVerbPast]?.past?.[subject];
                
                if (verbData) {
                    document.getElementById('sentencePast1').textContent = verbData.positive;
                    document.getElementById('sentencePast2').textContent = verbData.negative;
                    document.getElementById('sentencePast3').textContent = verbData.question;
                    document.getElementById('sentencePast4').textContent = verbData.whQuestion;
                    document.getElementById('schemeInfoPast').textContent = 'Past Simple: same form for all subjects';
                }
                
            } catch (error) {
                console.error('Error:', error);
            }
            
            // Update verb info
            document.getElementById('currentVerbPast').textContent = `Current verb: ${currentVerbPast}`;
        }

        function nextSubjectPast() {
            if (!isLoading) {
                currentSubjectIndexPast++;
                if (currentSubjectIndexPast >= allSubjects.length) {
                    currentSubjectIndexPast = 0; // Loop back to beginning
                }
                updatePastSimpleDisplay();
            }
        }

        function previousSubjectPast() {
            if (!isLoading) {
                currentSubjectIndexPast--;
                if (currentSubjectIndexPast < 0) {
                    currentSubjectIndexPast = allSubjects.length - 1; // Loop to end
                }
                updatePastSimpleDisplay();
            }
        }

        function changeVerbPast() {
            if (isLoading) return;
            
            // Get a random verb different from the current one
            let newVerb;
            do {
                newVerb = verbs[Math.floor(Math.random() * verbs.length)];
            } while (newVerb === currentVerbPast);
            
            currentVerbPast = newVerb;
            
            // Get a random subject
            currentSubjectIndexPast = Math.floor(Math.random() * allSubjects.length);
            
            updatePastSimpleDisplay();
        }

        // Audio Functions
        function speak(text) {
            if ('speechSynthesis' in window && audioEnabled) {
                // Cancel any ongoing speech
                window.speechSynthesis.cancel();
                
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'en-US';
                utterance.rate = 0.9; // Slightly slower for learning
                utterance.pitch = 1;
                utterance.volume = 1;
                
                window.speechSynthesis.speak(utterance);
            }
        }

        function playAudioPresent() {
            const sentences = [
                document.getElementById('sentence1').textContent,
                document.getElementById('sentence2').textContent,
                document.getElementById('sentence3').textContent,
                document.getElementById('sentence4').textContent
            ];
            
            // Speak all sentences with pauses
            let index = 0;
            function speakNext() {
                if (index < sentences.length) {
                    speak(sentences[index]);
                    index++;
                    setTimeout(speakNext, 2000); // 2 second pause between sentences
                }
            }
            speakNext();
        }

        function playAudioPast() {
            const sentences = [
                document.getElementById('sentencePast1').textContent,
                document.getElementById('sentencePast2').textContent,
                document.getElementById('sentencePast3').textContent,
                document.getElementById('sentencePast4').textContent
            ];
            
            let index = 0;
            function speakNext() {
                if (index < sentences.length) {
                    speak(sentences[index]);
                    index++;
                    setTimeout(speakNext, 2000);
                }
            }
            speakNext();
        }

        function playAudioFuture() {
            const sentences = [
                document.getElementById('sentenceFuture1').textContent,
                document.getElementById('sentenceFuture2').textContent,
                document.getElementById('sentenceFuture3').textContent,
                document.getElementById('sentenceFuture4').textContent
            ];
            
            let index = 0;
            function speakNext() {
                if (index < sentences.length) {
                    speak(sentences[index]);
                    index++;
                    setTimeout(speakNext, 2000);
                }
            }
            speakNext();
        }

        function playAudioPresentPerfect() {
            const sentences = [
                document.getElementById('sentencePresentPerfect1').textContent,
                document.getElementById('sentencePresentPerfect2').textContent,
                document.getElementById('sentencePresentPerfect3').textContent,
                document.getElementById('sentencePresentPerfect4').textContent
            ];
            
            let index = 0;
            function speakNext() {
                if (index < sentences.length) {
                    speak(sentences[index]);
                    index++;
                    setTimeout(speakNext, 2000);
                }
            }
            speakNext();
        }

        function playAudioPastPerfect() {
            const sentences = [
                document.getElementById('sentencePastPerfect1').textContent,
                document.getElementById('sentencePastPerfect2').textContent,
                document.getElementById('sentencePastPerfect3').textContent,
                document.getElementById('sentencePastPerfect4').textContent
            ];
            
            let index = 0;
            function speakNext() {
                if (index < sentences.length) {
                    speak(sentences[index]);
                    index++;
                    setTimeout(speakNext, 2000);
                }
            }
            speakNext();
        }

        // Test Yourself Functions
        function generateNewTest() {
            // Reset reveal stage
            revealStage = 0;
            
            // Reset complete state
            document.getElementById('testContainer').classList.remove('complete');
            
            // Ensure Russian is visible and all English sentences are hidden
            document.getElementById('russianSentence').style.display = 'block';
            document.getElementById('russianSentence').classList.remove('hidden');
            document.querySelectorAll('.english').forEach(el => {
                el.classList.add('hidden');
                el.style.display = 'none';
            });
            
            // Get random subject, verb, and tense
            const randomSubject = allSubjects[Math.floor(Math.random() * allSubjects.length)];
            const randomVerb = verbs[Math.floor(Math.random() * verbs.length)];
            const tenses = ['present', 'past', 'future', 'presentPerfect', 'pastPerfect'];
            const randomTense = tenses[Math.floor(Math.random() * tenses.length)];
            
            // Get verb data from dictionary
            const verbData = verbDictionary[randomVerb]?.[randomTense]?.[randomSubject];
            
            if (verbData) {
                // Display Russian translation
                const russianEl = document.getElementById('russianSentence');
                
                // Create tense badge
                let tenseDisplayName = '';
                let tenseClass = '';
                
                switch(randomTense) {
                    case 'present':
                        tenseDisplayName = 'Present Simple';
                        tenseClass = 'present';
                        break;
                    case 'past':
                        tenseDisplayName = 'Past Simple';
                        tenseClass = 'past';
                        break;
                    case 'future':
                        tenseDisplayName = 'Future Simple';
                        tenseClass = 'future';
                        break;
                    case 'presentPerfect':
                        tenseDisplayName = 'Present Perfect';
                        tenseClass = 'present-perfect';
                        break;
                    case 'pastPerfect':
                        tenseDisplayName = 'Past Perfect';
                        tenseClass = 'past-perfect';
                        break;
                }
                
                russianEl.innerHTML = `
                    <span class="tense-badge ${tenseClass}" aria-label="Use ${tenseDisplayName} tense">‚è± ${tenseDisplayName}</span>
                    ${verbData.russian}
                `;
                russianEl.classList.remove('hidden');
                russianEl.style.display = 'block';
                
                // Store English sentences (hidden)
                document.getElementById('englishPositive').textContent = verbData.positive;
                document.getElementById('englishNegative').textContent = verbData.negative;
                document.getElementById('englishQuestion').textContent = verbData.question;
                document.getElementById('englishWhQuestion').textContent = verbData.whQuestion;
                
                currentTestData = { sentences: [
                    verbData.positive,
                    verbData.negative,
                    verbData.question,
                    verbData.whQuestion
                ]};
            }
        }

        function revealNext() {
            const elements = [
                'englishPositive',
                'englishNegative', 
                'englishQuestion',
                'englishWhQuestion'
            ];
            
            if (revealStage < elements.length) {
                const element = document.getElementById(elements[revealStage]);
                element.classList.remove('hidden');
                element.style.cssText = 'display: block !important; visibility: visible !important; opacity: 1 !important;';
                revealStage++;
                
                // Mark as complete when all revealed
                if (revealStage === elements.length) {
                    document.getElementById('testContainer').classList.add('complete');
                }
            }
        }
    </script>
</body>
</html>
